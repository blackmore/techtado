<html>
<head>
	<title>Rcov Code Coverage Results</title>
	<style>
	body {
	background-color: #efefef;
	margin: 20px;
	padding: 0;
	font: 12px verdana, arial, helvetica;
}

table {
	border-collapse: collapse;
	border: 1px solid #666;
	background: #fff;
	margin-bottom: 20px;	
}

	table tr.light {
	 	background: #fff;
	}

	table tr.dark {
		background: #f9f9f9;
	}

	table td, table th {
		padding: 4px 10px;
		font-size: 13px;
	}
	table th {
		text-align: center;
		color: #fc0;
		background: #336;		
		font-weight: bold;
		border: #d0d0d0 1px solid;
	}

	table td {
		border: #d0d0d0 1px solid;
	}
	
		table td.score {
			text-align: right;
		}	

.warning {
	background: yellow;
}
.rcov_code td {
  border-bottom: 1px solid #ddd ;
  padding: 0;
  margin: 0;
}
.rcov_code tr {
  border: 0px;
  padding:0px;
  margin: 0px;
}
.rcov_code pre {
  border: 0px;
  padding: 0px;
  margin: 0px;
}
.rcov_run {}
.rcov_not_run {
  background-color: #d88;
}
	
	</style>
</head>

<body>
	<h1>Rcov Code Coverage Results</h1>
	<p>C0 code coverage information.</p>
  <p>Total Coverage: 35.1% </p>
	<table>
    <tr>
      <th>File Path</th>
      <th>Percent run</th>
    </tr>
    
    
      <tr>
        <td>app/controllers/tasks_controller.rb</td>
        <td>25</td>
      </tr>
      
		
      <tr>
        <td>app/controllers/customers_controller.rb</td>
        <td>50</td>
      </tr>
      
		
      <tr>
        <td>app/models/comment.rb</td>
        <td>50</td>
      </tr>
      
		
      <tr>
        <td>app/helpers/password_resets_helper.rb</td>
        <td>100</td>
      </tr>
      
		
      <tr>
        <td>app/models/customer.rb</td>
        <td>44</td>
      </tr>
      
		
      <tr>
        <td>app/controllers/user_sessions_controller.rb</td>
        <td>36</td>
      </tr>
      
		
      <tr>
        <td>app/helpers/user_sessions_helper.rb</td>
        <td>100</td>
      </tr>
      
		
      <tr>
        <td>app/models/postoffice.rb</td>
        <td>22</td>
      </tr>
      
		
      <tr>
        <td>app/models/video.rb</td>
        <td>42</td>
      </tr>
      
		
      <tr>
        <td>app/helpers/videos_helper.rb</td>
        <td>18</td>
      </tr>
      
		
      <tr>
        <td>app/controllers/videos_controller.rb</td>
        <td>18</td>
      </tr>
      
		
      <tr>
        <td>app/helpers/users_helper.rb</td>
        <td>29</td>
      </tr>
      
		
      <tr>
        <td>app/models/user_session.rb</td>
        <td>100</td>
      </tr>
      
		
      <tr>
        <td>app/controllers/application_controller.rb</td>
        <td>54</td>
      </tr>
      
		
      <tr>
        <td>app/models/user.rb</td>
        <td>49</td>
      </tr>
      
		
      <tr>
        <td>app/models/task.rb</td>
        <td>98</td>
      </tr>
      
		
      <tr>
        <td>app/controllers/comments_controller.rb</td>
        <td>13</td>
      </tr>
      
		
      <tr>
        <td>app/helpers/tasks_helper.rb</td>
        <td>27</td>
      </tr>
      
		
      <tr>
        <td>app/helpers/comments_helper.rb</td>
        <td>29</td>
      </tr>
      
		
      <tr>
        <td>app/helpers/application_helper.rb</td>
        <td>38</td>
      </tr>
      
		
      <tr>
        <td>app/controllers/password_resets_controller.rb</td>
        <td>28</td>
      </tr>
      
		
      <tr>
        <td>app/controllers/users_controller.rb</td>
        <td>39</td>
      </tr>
      
		
  </table>

  
    <h2> app/controllers/tasks_controller.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class TasksController < ApplicationController</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :require_user, :except => [:index, :show, :archive, :search ]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :created_by, :only => :create</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :show_query, :only => [:update_show_page, :update_index_page]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # GET /tasks</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # GET /tasks.xml</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def index</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       store_location</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @tasks = Task.outstanding.paginate :page => params[:page]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @recently_completed_tasks = Task.recently_completed</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @frozen_tasks = Task.frozen</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.html #index.html.erb</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.xml  { render :xml => @tasks }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.atom</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # GET /tasks/1</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # GET /tasks/1.xml</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def show</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       store_location</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if params[:status]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.html { render :action => 'show', :layout => 'showpage'}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.xml  { render :xml => @task }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # GET /tasks/new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # GET /tasks/new.xml</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.html # new.html.erb</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.xml  { render :xml => @task }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # GET /tasks/1/edit</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def edit</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # POST /tasks</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # POST /tasks.xml</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def create</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.new(params[:task])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         if @task.save</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           spawn do</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             @task.deliver_notify!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           flash[:notice] = 'Task was successfully created.'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.html { redirect_to(@task) }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.xml  { render :xml => @task, :status => :created, :location => @task }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.js</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.html { render :action => "new" }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.xml  { render :xml => @task.errors, :status => :unprocessable_entity }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.js</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # PUT /tasks/1</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # PUT /tasks/1.xml</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def update</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         if @task.update_attributes(@params)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           flash[:notice] = 'Task was successfully updated.'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.html { redirect_to(@task) }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.xml  { head :ok }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.html { render :action => "edit" }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           format.xml  { render :xml => @task.errors, :status => :unprocessable_entity }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # DELETE /tasks/1</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # DELETE /tasks/1.xml</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def destroy</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task.destroy</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.html { redirect_to(tasks_url) }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.xml  { head :ok }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def archive</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @tasks = Task.finished.paginate :page => params[:page], :order => 'created_at DESC'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.html { render :layout => 'archive'}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.xml  { render :xml => @tasks }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def search</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @tasks = Task.search(params[:search])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @search_query = params[:search]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.html { render :layout => 'search'}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.xml  { render :xml => @tasks }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def update_index_page</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @state = params[:status]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           if @task.update_attributes(@state_params)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             if @task.send_email</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>               spawn do</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                 @task.deliver_status_changed!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>               end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             format.html {redirect_to(tasks_path)}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             format.js { render :partial => 'update_index'}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             format.html {render :action => "index"}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def update_show_page</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           if @task.update_attributes(@state_params)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             if @task.send_email</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>               spawn do</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                 @task.deliver_status_changed!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>               end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             format.html {redirect_to(tasks_path)}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             format.js { render :partial => 'update_show_page'}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             format.html {render :action => "index"}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     private</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def created_by</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       params[:task].merge!('user_id' => current_user.id,</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                            'status' => 1,</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                            'assigned_to' => nil,</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                            'resubmit' => 0 )</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def show_query</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if params[:status]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @task = Task.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         status = params[:status]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @state_params = case status</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                         when 'finished' : { :status => -1, :finished_by => current_user.id, :finished_at => Time.now, :urgent => nil }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                         when 'bounce' : { :status => 1, :assigned_to => nil, :assigned_at => nil }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                         when 'assign_to_user' : { :status => 0, :assigned_to => current_user.id,:assigned_at => Time.now }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                         when 'resubmit' : { :status => 1, :assigned_to => nil, :assigned_at => nil, :finished_by => nil, :finished_at => nil, :resubmitted_at => Time.now, :resubmitted_by => current_user.id, :resubmit => @task.resubmit + 1 }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/controllers/customers_controller.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class CustomersController < ApplicationController</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def index</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @customers = Customer.find(:all, :conditions => ['name LIKE ?', "%#{params[:search]}%"])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/models/comment.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class Comment < ActiveRecord::Base</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     belongs_to :task</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def full_name</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       User.find(user_id).full_name</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def first_name</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       User.find(user_id).first_name</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/helpers/password_resets_helper.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   module PasswordResetsHelper</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/models/customer.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class Customer < ActiveRecord::Base</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     has_many :videos</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def customer_name</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       self.name if customer</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def customer_name=(name)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       self.name = Customer.find_or_create_by_name(name) unless name.blank?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def video_attributes=(video_attributes)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       video_attributes.each do |attributes|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         videos.build(attributes)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/controllers/user_sessions_controller.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class UserSessionsController < ApplicationController</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :require_no_user, :only => [:new, :create]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :require_user, :only => :destroy</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user_session = UserSession.new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @path = request.request_uri</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def create</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user_session = UserSession.new(params[:user_session])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if @user_session.save</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         flash[:notice] = "Login successful!"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         redirect_to session[:return_to]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         render :action => :new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def destroy</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       current_user_session.destroy</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       flash[:notice] = "Logout successful!"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       redirect_to tasks_url</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/helpers/user_sessions_helper.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   module UserSessionsHelper</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/models/postoffice.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class Postoffice < ActionMailer::Base</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # make note of the headers, content type, and time sent</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # these help prevent your email from being flagged as spam SPAM</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     default_url_options[:host] = "10.1.1.211"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       def status_changed(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @recipients   = task.user.email</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @from         = "Tech-tado <noreply@titelbild.de>"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         headers         "Reply-to" => "tech@titelbild.de"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @subject      = "Ref: #{subject_task(task.description)}"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @sent_on      = Time.now</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @content_type = "text/html"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         body[:status] = task.status_to_str</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         body[:task] = task </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         body[:link_to_show_task] = task_url(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       def notify(emails, task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @recipients   = emails</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @from         = "Tech-tado <noreply@titelbild.de>"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         headers         "Reply-to" => "tech@titelbild.de"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @subject      = "#{task.urgent ? 'URGENT!' : 'New'} task added to Tech tado."</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @sent_on      = Time.now</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @content_type = "text/html"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         body[:task] = task</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         body[:link_to_show_task] = task_url(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       def comment_notify(task, emails)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @recipients   = emails</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @from         = "Tech-tado <noreply@titelbild.de>"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         headers         "Reply-to" => "tech@titelbild.de"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @subject      = "#{task.comments.last.first_name} commented on \"#{subject_task(task.description)}\""</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @sent_on      = Time.now</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @content_type = "text/html"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         body[:latest_comment] = task.comments.last</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         body[:task] = task </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         body[:link_to_show_task] = task_url(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>        def password_reset_instructions(user)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          subject       "Password Reset Instructions"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          from          "Tech-tado <noreply@titelbild.de>"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          recipients    user.email</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          sent_on       Time.now</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          body          :edit_password_reset_url => edit_password_reset_url(user.perishable_token)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>        </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>        def notification(video, emails, videos)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          @recipients   = emails</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          @from         = "Video_Archive <noreply@titelbild.de>"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          headers         "Reply-to" => "tech@titelbild.de"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          @subject      = "#{video.customer.name}, NEW! #{videos.length > 1 ? 'videos.' : 'video.'}" </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          @sent_on      = Time.now</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          @content_type = "text/html"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          body[:videos] = videos</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          body[:customer] = video.customer</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          #body[:link_to_show_task] = "..."#task_url(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>        </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>        private</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>        </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>        def subject_task(text, count = 37)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        	  if text =~ /\n/</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             split_on_return = text.split(/\n/)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             string = split_on_return[0]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             string = text</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         	if string.length >= count </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         		shortened = string[0, count]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         		splitted = shortened.split(/\s/)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         		words = splitted.length</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         		splitted[0, words-1].join(" ")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         	else </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         		string</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         	end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/models/video.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class Video < ActiveRecord::Base</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_validation :round_up_length</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     belongs_to :customer</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     validates_presence_of :title</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     validates_presence_of :length</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     validates_presence_of :source_media</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     validates_presence_of :customer_id</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     validates_format_of :title, :with => /^.+\.mpg|avi|wmv|MPG|AIV|WMV$/, :on => :create, :message => "is invalid"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     validates_format_of :length, :with => /^\d+(.\d+|'\d+)?/, :on => :create, :message => "is invalid"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     SOURCES = ["film", "disc", "tape", "digital"]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def customer_name</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       customer.name if customer</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def customer_name=(name)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       name.chomp!(" ")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       self.customer = Customer.find_or_create_by_name(name) unless name.blank?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def round_up_length</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if self.length =~ /\d+'\d+/</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         self.length.gsub!("'", ".")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       self.length = self.length.to_f.ceil</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def details=(video_attributes)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def deliver_notification!(videos)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       # collect all the users that would like to be notified</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       notify_users = user_notify_custom_list(self.customer.name) + User.any_new_video</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       # put the email addresses into an array</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       notify_user_emails = notify_users.collect{ |i| i.email }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if !notify_users.empty?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         Postoffice.deliver_notification(self, notify_user_emails, videos)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def user_notify_custom_list(customer)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       users = User.custom_new_video</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if !users.empty?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         users.each do |user|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          customers = user.new_video_notify_filter.split(', ')</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          if !customers.include?(customer)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>            users.delete(user)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         users</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         []</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/helpers/videos_helper.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   module VideosHelper</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def pagination_links_remote(paginator)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       page_options = {:window_size => 1}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       pagination_links_each(paginator, page_options) do |n|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         options = {</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           :url => {:action => 'list', :params => params.merge({:page => n})},</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           :update => 'table',</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           :before => "Element.show('spinner')",</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           :success => "Element.hide('spinner')"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         html_options = {:href => url_for(:action => 'list', :params => params.merge({:page => n}))}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         link_to_remote(n.to_s, options, html_options)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def sort_td_class_helper(param)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       result = 'class="sortup"' if params[:sort] == param</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       result = 'class="sortdown"' if params[:sort] == param + "_reverse"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       return result</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def sort_link_helper(text, param)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       key = param</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       key += "_reverse" if params[:sort] == param</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       options = {</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           :url => {:action => 'list', :params => params.merge({:sort => key, :page => nil})},</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           :update => 'table',</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           :before => "Element.show('spinner')",</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           :success => "Element.hide('spinner')"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       html_options = {</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         :title => "Sort by this field",</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         :href => url_for(:action => 'list', :params => params.merge({:sort => key, :page => nil}))</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       link_to_remote(text, options, html_options)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/controllers/videos_controller.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class VideosController < ApplicationController</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def index</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @videos = Video.all</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def show</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @video = Video.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @videos = [Video.new]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def create</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @videos = []</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @videos_saved = []</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       for video in params[:video][:details]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @video = Video.new(video.merge(params[:video]))</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         unless @video.save</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           @videos << @video</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           @videos_saved << @video</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if !@videos_saved.empty?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         spawn do</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           @video.deliver_notification!(@videos_saved)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if @videos.empty?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         flash[:notice] = "Successfully created video."</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         redirect_to list_path</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         render :action => 'new'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def edit</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @video = Video.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def update</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @video = Video.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if @video.update_attributes(params[:video])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         flash[:notice] = "Successfully updated video."</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         redirect_to list_path</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         render :action => 'edit'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def destroy</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @video = Video.find(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @video.destroy</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       flash[:notice] = "Successfully destroyed video."</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       redirect_to list_path</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def list</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         store_location</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @video = Video.new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         filter_on = case params[:filter_on].to_i</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                      when 1 then "title"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                      when 2 then "customers.name"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                      end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                      </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         sort, @direction = case params[:sort]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           when "title"  then ["title", "title_down"]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           when "source_media"   then ["source_media", "source_down"]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           when "customer" then ["customers.name", "customers_down"]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           when "created"  then ["created_at", "created_down"]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           when "title_reverse"  then ["title DESC", "title_up"]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           when "source_media_reverse"   then ["source_media DESC", "sources_up"]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           when "customer_reverse" then ["customers.name DESC", "customers_up"]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           when "created_reverse"  then ["created_at DESC", "videos_up"]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           else "videos.created_at DESC"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                           end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         conditions = ["#{filter_on} LIKE ?", "%#{params[:query]}%"] unless params[:query].nil?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @videos = Video.find(:all, :include => [:customer], :order => sort, :conditions => conditions)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         if request.xml_http_request?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           render :partial => "videos_list", :layout => false</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/helpers/users_helper.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   module UsersHelper</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def hidden_video_filter(user)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if !user.filtered_customers.empty?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         user.filtered_customers</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/models/user_session.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class UserSession < Authlogic::Session::Base</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>      # various configuration goes here, see AuthLogic::Session::Config for more details</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/controllers/application_controller.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   # Filters added to this controller apply to all controllers in the application.</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   # Likewise, all the methods added will be available for all controllers.</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   class ApplicationController < ActionController::Base</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     helper :all # include all helpers, all the time</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # See ActionController::RequestForgeryProtection for details</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # Uncomment the :secret if you're not using the cookie session store</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     protect_from_forgery # :secret => 'af9440df0c2e624d19f801fdfa832d83'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # See ActionController::Base for details </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # Uncomment this to filter the contents of submitted sensitive data parameters</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # from your application log (in this case, all fields with names like "password"). </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     # filter_parameter_logging :password</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- Authlogic -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       filter_parameter_logging :password, :password_confirmation</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       helper_method :current_user_session, :current_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- * -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #-----  localized  -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       before_filter :set_user_language</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- * -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       private</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- Authlogic -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         def current_user_session</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           return @current_user_session if defined?(@current_user_session)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           @current_user_session = UserSession.find</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         def current_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           return @current_user if defined?(@current_user)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           @current_user = current_user_session && current_user_session.user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     	def require_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           unless current_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             store_location</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             flash[:notice] = "You must be logged in to access this page"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             redirect_to new_user_session_url</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             return false</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         def require_no_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           if current_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             store_location</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             flash[:notice] = "You must be logged out to access this page"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             redirect_to account_url</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             return false</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         def store_location</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           session[:return_to] = request.request_uri</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         def redirect_back_or_default(default)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           redirect_to(session[:return_to] || default)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           session[:return_to] = nil</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- * -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #-----  localized  -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       def set_user_language</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         if current_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           I18n.locale = current_user.language</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           I18n.locale = 'en'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     #----- * -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/models/user.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class User < ActiveRecord::Base</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     named_scope :any_new_video, :conditions => {:new_video_notify => 'all'}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     named_scope :custom_new_video, :conditions => {:new_video_notify => 'custom'}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       def before_save</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         if self.task_notify == false</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           self.notify_on = "None"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- Authlogic -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       acts_as_authentic</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       validates_presence_of :first_name, :last_name</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       def deliver_password_reset_instructions!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         reset_perishable_token!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         Postoffice.deliver_password_reset_instructions(self)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- * -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def full_name</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       [first_name, last_name].join(' ')</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #----- LANGUAGES -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         LANG = [  ]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #----- * -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #----- NOTIFY -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       def self.notify(urgent)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         if urgent</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           users_urgent = find_all_by_notify_on("urgent").collect{ |user| user.email}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           users_create = find_all_by_notify_on("create").collect{ |user| user.email}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           users = users_urgent + users_create</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           users.uniq</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           users = find_all_by_notify_on("create").collect{ |user| user.email}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #----- * -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #------ Video Archive -------#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       def filtered_customers</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         if self.new_video_notify_filter != nil</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           customers = self.new_video_notify_filter.split(', ')</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           []</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/models/task.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class Task < ActiveRecord::Base</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     belongs_to :user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     has_many :comments</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     named_scope :to_do, :conditions => {:status => 1}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     named_scope :outstanding, :conditions => ['status >= ?', 0 ]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     named_scope :marked_as_wip, :conditions => {:status => 0}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     named_scope :frozen, :conditions => {:status => -2}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     named_scope :finished, :conditions => {:status => -1}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     named_scope :recently_completed, :conditions => {:status => -1}, :order => 'finished_at DESC', :limit => '6'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def self.search(search)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if search</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         find(:all, :conditions => ['description LIKE ?', "%#{search}%"])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         outstanding</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def self.per_page</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       15</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def status_to_str</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       case status</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       when 1 : "To Do"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       when 0 : "Being worked on"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       when -1 : "Finished"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def deliver_status_changed!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       Postoffice.deliver_status_changed(self)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def deliver_notify!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       @notify_users = User.notify(self.urgent)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       if @notify_users.length > 0</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         Postoffice.deliver_notify(@notify_users, self)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def deliver_comment_notify!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       user_id_list = [ self.user_id, self.assigned_to, self.finished_by ].uniq.compact</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       if user_id_list.include?(self.comments.last.user_id)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         user_id_list = user_id_list - [self.comments.last.user_id]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         exit if user_id_list == []</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       unless user_id_list.include?(self.comments.last.user_id)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         emails = user_id_list.collect{ |i| User.find(i).email }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         Postoffice.deliver_comment_notify(self, emails)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def freezed?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       status == -2</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/controllers/comments_controller.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class CommentsController < ApplicationController</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def create</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @task = Task.find(params[:task_id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if params[:freeze]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @task.update_attributes(:status  => -2)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         params[:comment][:body] = '<strong class="freeze">Frozen</strong>' + params[:comment][:body]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       elsif params[:unfreeze]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @task.update_attributes(:status  => 1)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         params[:comment][:body] = '<strong class="unfreeze">Unfrozen</strong>' + params[:comment][:body]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       params[:comment].merge!('user_id' => current_user.id)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @comment = @task.comments.create!(params[:comment])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       spawn do</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @task.deliver_comment_notify!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       respond_to do |format|</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.html { redirect_to @task }</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         format.js</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/helpers/tasks_helper.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   module TasksHelper</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def description_heading(description)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       string = find_description_head(description)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if description > string</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         string + ' ...'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         string</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	def find_description_head(text, count = 34)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	  if text =~ /\n/</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          split_on_return = text.split(/\n/)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          string = split_on_return[0]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          string = text</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      	if string.length >= count </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		shortened = string[0, count]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		splitted = shortened.split(/\s/)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		words = splitted.length</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		splitted[0, words-1].join(" ")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      	else </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		string</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      	end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	def description_heading_sidebar(description)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       string = find_description_head_sidebar(description)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if description > string</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         string + ' ...'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         string</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	def find_description_head_sidebar(text, count = 27)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	  if text =~ /\n/</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          split_on_return = text.split(/\n/)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          string = split_on_return[0]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          string = text</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      	if string.length >= count </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		shortened = string[0, count]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		splitted = shortened.split(/\s/)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		words = splitted.length</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		splitted[0, words-1].join(" ")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      	else </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      		string</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      	end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	def get_status(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	  s = task.status</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	  case s</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     	  when -1 : 'tsk_statusFinished'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     	  when 0 :  'tsk_statusWIP'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     	  when -2 :  'tsk_statusFreeze'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else  'tsk_statusTodo'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	  end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	def get_user_name(n)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	  user = User.find(n)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	  user.first_name</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   	end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   	</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def resubmitted(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       value = task.resubmit</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if value > 0</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         case value</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         when 1: " - <span class='reSubmit_1'>#{t('task.details.resubmitted')} #{task.resubmit}</span>"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         when 2: " - <span class='reSubmit_2'>#{t('task.details.resubmitted')} #{task.resubmit}</span>"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         when 3: " - <span class='reSubmit_3'>#{t('task.details.resubmitted')} #{task.resubmit}</span>"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else    " - <span class='reSubmit'>#{t('task.details.resubmitted')} #{task.resubmit}</span>" </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def user_full_name(n)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if n</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         user = User.find(n)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         "#{user.first_name} #{user.last_name.first}."</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         "-"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def show_date(date)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if date</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         date.strftime("%d.%m.%y")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>         "-"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def format_text(text)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       text.gsub!(/\n/, "<br />")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       text</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def who_status_time(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       status = task.status</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       user_id, date = case status</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>                         when  0:  [task.assigned_to, task.assigned_at] </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>                         when -1:  [task.finished_by, task.finished_at]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                         else      task.resubmit > 0 ? [task.resubmitted_by, task.resubmitted_at] : [task.user_id, task.created_at]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>                       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       user = User.find(user_id)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       case status</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       when 0: "#{user.first_name.capitalize}'s #{t('task.assigned_to')} #{time_ago_in_words(date)}." </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       when -1: "#{user.first_name.capitalize} #{t('task.finished')} #{time_ago_in_words(date)} #{t('task.ago')}"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else    "#{user.first_name.capitalize} #{task.resubmit > 0 ? t('task.resubmitted') : t('task.submitted') } #{time_ago_in_words(date)} #{t('task.ago')}"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def show_description(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       description = task.description</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       headding = find_description_head(description)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if description > headding</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @headding = headding</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         body = description.sub!(headding, "")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>          if body =~ /^\n/</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>            @description = body.sub!(/\n/, "")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           body.gsub!(/\n/, "<br />")</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           @description = body</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @headding = headding</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @description = ""</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def change_status_link(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       status = task.status</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if current_user && !task.freezed?</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         user_id = current_user.id</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         if status == 0 && task.assigned_to == user_id</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           link = link_to_remote t('task.status_link.bounce'), :url => update_show_page_path(@task, :status => 'bounce' ), :html => {:class => "change_status"}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           link = link_to_remote t('task.status_link.snatch'), :url => update_show_page_path(@task, :status => 'assign_to_user'), :html => {:class => "change_status"}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         case status</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         when 0: link</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         when -1: link_to_remote t('task.status_link.resubmit'), :url => update_show_page_path(@task, :status => 'resubmit'), :html => {:class => "change_status"}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else     link_to_remote t('task.status_link.Ill_do_this'), :url => update_show_page_path(@task, :status => 'assign_to_user'), :html => {:class => "change_status"}</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def comments(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       number = task.comments.length</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if number > 0</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         link_to "#{number}" + (number > 1 ? t('task.comment.plural') : t('task.comment.singular')), task, :class => "tsk_comments"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         if current_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           link_to('add comment', task, :class => "tsk_comments" )</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           'No comments'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def belongs_to_user(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if current_user.id == task.assigned_to</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         'belongs_to_user'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         ''</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- MAYBE_USE_LATER -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #  def urgent?(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #    if task.urgent</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #      '<div class="urgent"></div>'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #    else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #      '<div class="not_urgent"></div>'</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #    end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       #  end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>    def urgent?(task)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      if task.urgent</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        "urgent#{rand(2)}"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>        ''</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>      end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>    end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     	</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/helpers/comments_helper.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   module CommentsHelper</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def comment_details(comment)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       user = User.find(comment.user_id)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       "Posted by #{user.first_name} #{user.last_name} #{time_ago_in_words(comment.created_at)} ago"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/helpers/application_helper.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   # Methods added to this helper will be available to all templates in the application.</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   module ApplicationHelper</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #-----  adds a active class to the current page tab.  -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def is_active?(page)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if current_page?(:controller => page)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         "class='active'"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         ""</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- * -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     #----- SHORT_TIME_AGO -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def short_time_ago(time)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       string = time_ago_in_words(time)</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       string.gsub!('about', '')</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       string.gsub!('hours', 'hrs')</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       string.gsub!('minutes', 'mins')</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       string.gsub!('less than', 'under')</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       string</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     #----- * -----#</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/controllers/password_resets_controller.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class PasswordResetsController < ApplicationController</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :require_no_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :load_user_using_perishable_token, :only => [:edit, :update]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       render</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def create</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user = User.find_by_email(params[:email])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if @user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         spawn do</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           @user.deliver_password_reset_instructions!</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         flash[:notice] = "Instructions to reset your password have been emailed to you. " +</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           "Please check your email."</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         redirect_to root_url</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         flash[:notice] = "No user was found with that email address"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         render :action => :new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def edit</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       render</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def update</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user.password = params[:user][:password]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user.password_confirmation = params[:user][:password_confirmation]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if @user.save</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         flash[:notice] = "Password successfully updated"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         redirect_to tasks_url</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         render :action => :edit</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     private</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>       def load_user_using_perishable_token</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         @user = User.find_using_perishable_token(params[:id])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         unless @user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           flash[:notice] = "We're sorry, but we could not locate your account. " +</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             "If you are having issues try copying and pasting the URL " +</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             "from your email into your browser or restarting the " +</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>             "reset password process."</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>           redirect_to root_url</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
    <h2> app/controllers/users_controller.rb</h2>
    <table class="rcov_code">
    
      <tr>
        
        <td class="rcov_run"><pre>   class UsersController < ApplicationController</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :require_no_user, :only => [:new, :create]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :require_user, :only => [:show, :edit, :update]</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     before_filter :set_login_to_email, :only => :create</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user = User.new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def create</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user = User.new(params[:user])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if @user.save</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         flash[:notice] = "Account registered!"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         redirect_to tasks_url</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         render :action => :new</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def show</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user = @current_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def edit</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user = @current_user</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>   </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def update</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       @user = @current_user # makes our views "cleaner" and more consistent</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       if @user.update_attributes(params[:user])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         flash[:notice] = "Account updated!"</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         redirect_to tasks_url</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       else</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>         render :action => :edit</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     </pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_run"><pre>     def set_login_to_email</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>       params[:user].merge!('login' => params[:user][:email])</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>     end</pre></td>
      </tr>
    
      <tr>
        
        <td class="rcov_not_run"><pre>   end</pre></td>
      </tr>
    
    </table>
  
	<p>Generated on Thu Jun 25 11:59:24 +0200 2009</p>	
</body>
</html>

